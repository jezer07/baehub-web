<% if task.errors.any? %>
  <div class="form-error-wrapper mb-6">
    <h3 class="form-error-title">
      <%= pluralize(task.errors.count, "error") %> prohibited this from being saved:
    </h3>
    <ul class="form-error-list">
      <% task.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= form_with model: task, class: "space-y-5" do |f| %>
  <div>
    <%= f.label :title, "Task title", class: "form-label" %>
    <%= f.text_field :title, required: true, autofocus: true, class: "form-control w-full px-4 py-3" %>
  </div>

  <div>
    <%= f.label :description, "Description (optional)", class: "form-label" %>
    <%= f.text_area :description, rows: 4, class: "form-control w-full px-4 py-3" %>
  </div>

  <div>
    <%= f.label :status, "Status", class: "form-label" %>
    <%= f.select :status, Task.statuses.keys.map { |s| [s.humanize, s] }, {}, class: "form-control w-full px-4 py-3" %>
  </div>

  <div>
    <%= f.label :priority, "Priority", class: "form-label" %>
    <%= f.select :priority, Task.priorities.keys.map { |p| [p.humanize, p] }, {}, class: "form-control w-full px-4 py-3" %>
  </div>

  <div>
    <%= f.label :due_at, "Due date (optional)", class: "form-label" %>
    <%= f.datetime_local_field :due_at, class: "form-control w-full px-4 py-3" %>
  </div>

  <div>
    <%= f.label :assignee_id, "Assign to (optional)", class: "form-label" %>
    <%= f.collection_select :assignee_id, current_user.couple.users, :id, :name, { include_blank: "Unassigned" }, class: "form-control w-full px-4 py-3" %>
  </div>

  <% if local_assigns[:redirect_to].present? %>
    <%= hidden_field_tag :redirect_to, local_assigns[:redirect_to] %>
  <% end %>

  <div class="flex justify-end">
    <%= f.submit class: "btn-primary" %>
  </div>
<% end %>
