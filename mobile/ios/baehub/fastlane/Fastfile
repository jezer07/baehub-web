# Fastfile for Baehub iOS
# For more details about this file, check out:
# https://docs.fastlane.tools/advanced/Fastfile

default_platform(:ios)

platform :ios do
  desc "Build and upload to App Store Connect"
  lane :release do
    # Get the latest build number from the project
    increment_build_number(xcodeproj: "baehub.xcodeproj")
    
    # Build the iOS app
    build_app(
      project: "baehub.xcodeproj",
      scheme: "baehub",
      configuration: "Release",
      export_method: "app-store",
      xcargs: "-allowProvisioningUpdates DEVELOPMENT_TEAM=DFX68NJV25"
    )
    
    # Upload to App Store Connect
    upload_to_app_store(
      app_identifier: "com.zlatoapps.baehub",
      skip_screenshots: true,
      skip_metadata: true
    )
  end

  desc "Build a development version"
  lane :build do
    build_app(
      project: "baehub.xcodeproj",
      scheme: "baehub",
      configuration: "Debug",
      xcargs: "-allowProvisioningUpdates -allowProvisioningDeviceRegistration"
    )
  end
end
